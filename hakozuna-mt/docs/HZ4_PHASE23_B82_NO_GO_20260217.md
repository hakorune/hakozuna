# HZ4 Phase23: B82 Final One-Shot - NO-GO (Stage A Failed)

**Date**: 2026-02-17
**Status**: NO-GO (Stage A criteria not met)
**Consequence**: **hz4 mid optimization line FROZEN**

---

## Stage A Results

### Key Metrics
| Metric | Value | Threshold | Result |
|--------|-------|-----------|--------|
| `malloc_lock_path / malloc_calls` | **4.00%** | >= 10% | **FAIL** |

### Raw Data (representative run)
```
malloc_calls = 9,006,065
malloc_lock_path = 360,046
lock_path_ratio = 0.0400 (4.00%)
```

### Lock Time Stats
```
lock_enter = 360,046
hold_page_create_calls = 34-42 per run
hold_page_create_ns_sum = ~500K-1.2M ns
inlock_remote_drain_calls = 5-19 per run
```

### Perf Stats (main_r0)
```
15,517,203,161 cycles
 4,207,978,995 instructions (0.27 IPC)
    32,179,074 branch-misses
   121,090,776 cache-misses
         8,130 context-switches
        54,639 page-faults
       0.40326 seconds
```

---

## Decision

Stage A criterion **not met**:
- `malloc_lock_path / malloc_calls = 4.00% < 10% threshold`

**hz4 mid optimization line is now FROZEN.**

No Stage B implementation will be attempted.

---

## Rationale

The lock path accounts for only ~4% of allocations. Moving page creation outside the lock would:
1. Add complexity (rescan logic, race condition handling)
2. Provide minimal benefit (4% of 4% = negligible)
3. Risk regression (as seen in B47 with cross128_r90 -6.47%)

---

## Files (No Changes)

No code modifications were made. Stage A was observation-only.

---

## Deliverables

- `/tmp/hz4_b82_stagea_perf_20260217_104045/` - Stage A perf results
- This document: `HZ4_PHASE23_B82_NO_GO_20260217.md`

---

## Next Steps

Per work order:
- **hz4 mid is FROZEN** - no further optimization attempts
- Prioritize non-mid tracks:
  - `hz4 large` optimization
  - `hz3 aggressive lane`

---

## Historical Context

| Box | Status | Notes |
|-----|--------|-------|
| B47 | NO-GO | cross128_r90 -6.47% |
| B58 | NO-GO | parameter sweep failed |
| B77c | NO-GO | code bloat regression |
| B80/B81 | NO-GO | knob sweeps failed |
| **B82** | **NO-GO** | Stage A criteria not met (4% < 10%) |
