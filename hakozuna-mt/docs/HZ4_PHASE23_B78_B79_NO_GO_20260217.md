# HZ4 Phase23: B78/B79 NO-GO Summary (2026-02-17)

## Scope
- `B78 MidMallocHotColdSplitBox`
- `B79 MidPageSupplyReservationAdaptiveChunkBox`

Both were tested after B77 archive, with B70 default baseline kept unchanged.

---

## B78: MidMallocHotColdSplitBox

### Intent
- Keep `hz4_mid_malloc()` hot path compact by moving lock-path body into a cold/noinline function.
- Avoid adding always-on work to `hz4_free()` boundary.

### Implementation
- `HZ4_MID_MALLOC_HOT_COLD_SPLIT_BOX` (opt-in, default OFF)
- lock-path extracted to `hz4_mid_malloc_lock_path(sc)`.

### Replay-like result (`RUNS=21`, median)
- `guard_r0`: `+0.54%`
- `main_r0`: `+0.24%`
- `main_r50`: `-0.14%`
- `cross128_r90`: `-0.81%`

### Verdict
- **NO-GO** (no meaningful win; promotion gate not met).

### Notes
- `main_r0` uplift was too small to justify extra maintenance complexity.
- `main_r50/cross` stayed flat-to-negative.

---

## B79: MidPageSupplyReservationAdaptiveChunkBox

### Intent
- Keep B70 mechanism, but choose reservation chunk size by `obj_size` at page-create refill boundary.
- Reduce lock traffic for smaller-mid while avoiding remote-heavy regression.

### Implementation
- `HZ4_MID_PAGE_SUPPLY_RESV_ADAPTIVE_BOX` (opt-in, default OFF)
- tested variants:
  - V1: `SMALL=16`, `LARGE=4`, `SPLIT=32768`
  - V2: `SMALL=16`, `LARGE=8`, `SPLIT=32768`

### Screen result (`RUNS=7`, median)
- V1 (`16/4`):
  - `guard_r0 -0.61%`, `main_r0 +0.98%`, `main_r50 +1.76%`, `cross128_r90 -8.87%`
- V2 (`16/8`):
  - `guard_r0 -0.83%`, `main_r0 +0.08%`, `main_r50 +2.68%`, `cross128_r90 -1.93%`

### Verdict
- **NO-GO** (lane split; remote-heavy/cross degradation).

### Notes
- Adaptive chunking helped `main_r50` but could not keep `cross128_r90` non-regressive.
- Keep B70 default static setting (`CHUNK_PAGES=8`).

---

## Final Decision
- Archive both B78 and B79 as NO-GO.
- Revert runtime code changes for B78/B79 from mainline.
- Keep current baseline unchanged (`B70 default + existing promoted profile`).

## Evidence
- B78 run dir: `/tmp/hz4_b78_hotcold_20260217_095459/`
- B79 run dir: `/tmp/hz4_b79_adaptive_chunk_20260217_095828/`
